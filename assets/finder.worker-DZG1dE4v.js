(function(){"use strict";const w={MAX_SOLUTIONS:1e4};function M(r,s,c){const a=[];let i=!1;function t(l,f,y,h){if(a.length>=w.MAX_SOLUTIONS){i=!0;return}if(p(h,r.flavors)){const o=[];for(let n=0;n<s.length;n++)f[n]>0&&o.push({berry:s[n].berry,count:f[n]});a.push({donut:r,stocks:o});return}if(y===0||l>=s.length)return;const b=s[l],v=Math.min(b.count,y);for(let o=0;o<=v;o++){f[l]=o;const n={sweet:h.sweet+b.berry.flavors.sweet*o,spicy:h.spicy+b.berry.flavors.spicy*o,sour:h.sour+b.berry.flavors.sour*o,bitter:h.bitter+b.berry.flavors.bitter*o,fresh:h.fresh+b.berry.flavors.fresh*o};if(!m(n,r.flavors,y-o,s,l+1)){f[l]=0;continue}t(l+1,f,y-o,n),f[l]=0}}const e=new Array(s.length).fill(0);return t(0,e,c,{sweet:0,spicy:0,sour:0,bitter:0,fresh:0}),{recipes:a,limitReached:i}}function p(r,s){return r.sweet>=s.sweet&&r.spicy>=s.spicy&&r.sour>=s.sour&&r.bitter>=s.bitter&&r.fresh>=s.fresh}function m(r,s,c,a,i){if(c===0)return p(r,s);const t={...r},e={sweet:0,spicy:0,sour:0,bitter:0,fresh:0};for(let u=i;u<a.length;u++){const l=a[u];if(l.count>0){const f=l.berry.flavors;e.sweet=Math.max(e.sweet,f.sweet),e.spicy=Math.max(e.spicy,f.spicy),e.sour=Math.max(e.sour,f.sour),e.bitter=Math.max(e.bitter,f.bitter),e.fresh=Math.max(e.fresh,f.fresh)}}return t.sweet+=e.sweet*c,t.spicy+=e.spicy*c,t.sour+=e.sour*c,t.bitter+=e.bitter*c,t.fresh+=e.fresh*c,t.sweet>=s.sweet&&t.spicy>=s.spicy&&t.sour>=s.sour&&t.bitter>=s.bitter&&t.fresh>=s.fresh}self.onmessage=r=>{const{donut:s,stocks:c,slots:a}=r.data;try{const i=M(s,c,a),t={success:!0,result:{recipes:i.recipes,limitReached:i.limitReached}};self.postMessage(t)}catch(i){const t={success:!1,error:i instanceof Error?i.message:"Unknown error occurred"};self.postMessage(t)}}})();
